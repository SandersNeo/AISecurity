# Методы обнаружения

> **Подмодуль 05.1: Обнаружение атак до их успеха**

---

## Обзор

Обнаружение — первая линия защиты. Этот подмодуль охватывает спектр техник обнаружения, от простого сопоставления паттернов до продвинутого топологического анализа, обучая когда использовать каждый подход.

---

## Спектр обнаружения

| Метод | Скорость | Точность | Лучше для |
|-------|----------|----------|-----------|
| **Точное соответствие** | Самый быстрый | Низкая | Известные пейлоады |
| **Паттерн (regex)** | Быстро | Средняя | Известные паттерны |
| **Семантический** | Средне | Высокая | Перефразированные атаки |
| **Топологический** | Медленно | Очень высокая | Новые атаки |
| **ML-based** | Средне | Высокая | Сложные паттерны |

---

## Уроки

### [01. Обнаружение по сопоставлению паттернов](01-pattern-matching.md)
**Время:** 35 минут | **Сложность:** Начальный-Средний

Быстрое обнаружение на основе правил:
- Дизайн regex-паттернов
- Иерархическое сопоставление
- Паттерны, устойчивые к обходу
- Оптимизация производительности

### 02. Семантический анализ
**Время:** 40 минут | **Сложность:** Средний

Обнаружение на основе смысла:
- Сходство эмбеддингов
- Классификация намерения
- Обнаружение аномалий
- Гибридные подходы

### 03. Топологическое обнаружение
**Время:** 45 минут | **Сложность:** Продвинутый

Структурный анализ:
- Персистентная гомология
- Сигнатуры атак
- Топология эмбеддингов
- Обнаружение новых атак

### 04. Ансамблевые методы
**Время:** 40 минут | **Сложность:** Продвинутый

Комбинирование методов обнаружения:
- Стратегии голосования
- Взвешивание уверенности
- Каскадные архитектуры
- Оптимизация задержки

---

## Конвейер обнаружения

```
Входной текст
    │
    ▼
[ Быстрый блоклист ] ──заблокировано──► ОТКЛОНИТЬ
    │ пропуск
    ▼
[ Сопоставление паттернов ] ──высокая уверенность──► ОТКЛОНИТЬ
    │ не уверен
    ▼
[ Семантический анализ ] ──вероятно атака──► ОТКЛОНИТЬ
    │ не уверен
    ▼
[ Полный анализ ] ──подтверждённая атака──► ОТКЛОНИТЬ
    │ чисто
    ▼
РАЗРЕШИТЬ
```

---

## Ключевые инсайты

### Компромисс скорость vs точность

- **Продакшен** — Приоритет скорости, допускаем ложноотрицательные
- **Критичная безопасность** — Приоритет точности, допускаем задержку
- **Сбалансированный** — Многостадийный конвейер с ранним выходом

### Частые ошибки

| Ошибка | Последствие | Исправление |
|--------|-------------|-------------|
| Только regex | Легко обойти | Добавить семантический слой |
| Нет нормализации | Обход омоглифами | Нормализовать перед сопоставлением |
| Плоская архитектура | Медленно на масштабе | Использовать иерархический подход |

---

## Навигация

| Предыдущий | Текущий | Следующий |
|------------|---------|-----------|
| [Обзор модуля](../README.md) | **Обнаружение** | [Guardrails](../02-guardrails/) |

---

*AI Security Academy | Подмодуль 05.1*
