# ü§ñ –£—Ä–æ–∫ 4.3: Automated Pentesting

> **–í—Ä–µ–º—è: 30 –º–∏–Ω—É—Ç** | Mid-Level Module 4

---

## Continuous Testing

```yaml
# .github/workflows/ai-security.yml
name: AI Security Testing

on:
  schedule:
    - cron: '0 2 * * *'  # Daily 2 AM
  push:
    branches: [main]

jobs:
  pentest:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Start target
        run: docker-compose up -d
      
      - name: Run STRIKE
        run: |
          pip install sentinel-llm-security[strike]
          sentinel strike test \
            --target ${{ secrets.API_URL }} \
            --categories all \
            --fail-on-vuln \
            --output report.html
      
      - name: Upload report
        uses: actions/upload-artifact@v3
        with:
          name: strike-report
          path: report.html
```

---

## Scheduled Attacks

```python
from sentinel.strike import ScheduledAttacker
from apscheduler.schedulers.background import BackgroundScheduler

attacker = ScheduledAttacker(
    target_url="https://api.example.com/chat",
    categories=["injection", "jailbreak"],
    alert_webhook="https://slack.webhook/..."
)

scheduler = BackgroundScheduler()

# Daily quick scan
scheduler.add_job(
    attacker.quick_scan,
    'cron', hour=6, minute=0
)

# Weekly full scan
scheduler.add_job(
    attacker.full_scan,
    'cron', day_of_week='sun', hour=2
)

scheduler.start()
```

---

## Regression Testing

```python
# test_regressions.py
import pytest
from sentinel.strike import Attacker

@pytest.fixture
def attacker():
    return Attacker(target_url="http://localhost:8000/chat")

def test_no_injection_regressions(attacker):
    """Ensure previously fixed injections stay fixed."""
    
    known_payloads = load_json("known_vulnerabilities.json")
    
    for payload in known_payloads:
        result = attacker.test_single(payload["text"])
        
        assert result.blocked, f"Regression: {payload['id']} not blocked"
```

---

## Alert Integration

```python
from sentinel.strike.alerts import AlertManager

alerts = AlertManager(
    channels=[
        SlackChannel(webhook="..."),
        PagerDutyChannel(api_key="..."),
        EmailChannel(smtp_config={...})
    ]
)

# On vulnerability found
@attacker.on_vulnerability
def handle_vuln(vuln):
    alerts.send(
        severity="high",
        title=f"AI Vulnerability Found: {vuln.category}",
        details=vuln.to_dict()
    )
```

---

## –°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–∫

‚Üí [4.4: Reporting](./16-reporting.md)
