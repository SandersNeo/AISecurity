# ğŸ›¡ï¸ SENTINEL Framework â€” ĞŸĞ¾Ğ»Ğ½Ğ¾Ğµ Ğ ÑƒĞºĞ¾Ğ²Ğ¾Ğ´ÑÑ‚Ğ²Ğ¾

> **Ğ”Ğ»Ñ Ğ²ÑĞµÑ… ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ¹:** Ğ¾Ñ‚ Ğ½Ğ¾Ğ²Ğ¸Ñ‡ĞºĞ° Ğ´Ğ¾ Ğ¸ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ

---

## ğŸ“š Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸ ÑĞ²Ğ¾Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ

| Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ | Ğ”Ğ»Ñ ĞºĞ¾Ğ³Ğ¾ | Ğ§Ñ‚Ğ¾ ÑƒĞ·Ğ½Ğ°ĞµÑˆÑŒ |
|---------|----------|-------------|
| [ğŸŒŸ ĞĞ°Ñ‡Ğ¸Ğ½Ğ°ÑÑ‰Ğ¸Ğ¹](#-ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ-1-Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ÑÑ‰Ğ¸Ğ¹) | Ğ¨ĞºĞ¾Ğ»ÑŒĞ½Ğ¸ĞºĞ¸, Ğ½Ğ¾Ğ²Ğ¸Ñ‡ĞºĞ¸ Ğ² Python | Ğ§Ñ‚Ğ¾ Ñ‚Ğ°ĞºĞ¾Ğµ SENTINEL Ğ¸ Ğ·Ğ°Ñ‡ĞµĞ¼ Ğ¾Ğ½ Ğ½ÑƒĞ¶ĞµĞ½ |
| [ğŸ”§ ĞŸÑ€Ğ°ĞºÑ‚Ğ¸Ğº](#-ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ-2-Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸Ğº) | Ğ Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¸, DevOps | ĞšĞ°Ğº Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°Ñ… |
| [âš™ï¸ Ğ­ĞºÑĞ¿ĞµÑ€Ñ‚](#ï¸-ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ-3-ÑĞºÑĞ¿ĞµÑ€Ñ‚) | Senior Ğ¸Ğ½Ğ¶ĞµĞ½ĞµÑ€Ñ‹ | ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¸ ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ |
| [ğŸ”¬ Ğ˜ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ](#-ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ-4-Ğ¸ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ) | PhD, ÑƒÑ‡Ñ‘Ğ½Ñ‹Ğµ | ĞœĞ°Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¾ÑĞ½Ğ¾Ğ²Ñ‹ |

---

# ğŸŒŸ Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ 1: ĞĞ°Ñ‡Ğ¸Ğ½Ğ°ÑÑ‰Ğ¸Ğ¹

## Ğ§Ñ‚Ğ¾ Ñ‚Ğ°ĞºĞ¾Ğµ SENTINEL?

**SENTINEL â€” ÑÑ‚Ğ¾ Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ½Ğ¸Ğº Ğ´Ğ»Ñ Ğ¸ÑĞºÑƒÑÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Ğ¸Ğ½Ñ‚ĞµĞ»Ğ»ĞµĞºÑ‚Ğ°.**

ĞŸÑ€ĞµĞ´ÑÑ‚Ğ°Ğ²ÑŒ, Ñ‡Ñ‚Ğ¾ Ñƒ Ñ‚ĞµĞ±Ñ ĞµÑÑ‚ÑŒ ÑƒĞ¼Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰Ğ½Ğ¸Ğº (ĞºĞ°Ğº ChatGPT). ĞŸĞ»Ğ¾Ñ…Ğ¸Ğµ Ğ»ÑĞ´Ğ¸ Ğ¼Ğ¾Ğ³ÑƒÑ‚ Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚Ğ°Ñ‚ÑŒÑÑ Ğ¾Ğ±Ğ¼Ğ°Ğ½ÑƒÑ‚ÑŒ ĞµĞ³Ğ¾, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¾Ğ½ ÑĞ´ĞµĞ»Ğ°Ğ» Ñ‡Ñ‚Ğ¾-Ñ‚Ğ¾ Ğ¿Ğ»Ğ¾Ñ…Ğ¾Ğµ. SENTINEL Ğ·Ğ°Ñ‰Ğ¸Ñ‰Ğ°ĞµÑ‚ Ğ¾Ñ‚ Ñ‚Ğ°ĞºĞ¸Ñ… Ğ¾Ğ±Ğ¼Ğ°Ğ½Ğ¾Ğ²!

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Ğ§ĞµĞ»Ğ¾Ğ²ĞµĞº   â”‚ â”€â”€â–º â”‚  SENTINEL   â”‚ â”€â”€â–º â”‚     Ğ˜Ğ˜      â”‚
â”‚  (Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ)   â”‚     â”‚  (Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°) â”‚     â”‚  (Ğ¾Ñ‚Ğ²ĞµÑ‚)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                    âœ… Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾?
                    âŒ ĞĞ¿Ğ°ÑĞ½Ğ¾ â†’ Ğ‘Ğ»Ğ¾Ğº!
```

## ĞĞ½Ğ°Ğ»Ğ¾Ğ³Ğ¸Ñ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ

**SENTINEL ĞºĞ°Ğº Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ½Ğ¸Ğº Ğ² ÑˆĞºĞ¾Ğ»Ğµ:**

| Ğ’ ÑˆĞºĞ¾Ğ»Ğµ | Ğ’ SENTINEL |
|---------|------------|
| ĞÑ…Ñ€Ğ°Ğ½Ğ½Ğ¸Ğº Ñƒ Ğ²Ñ…Ğ¾Ğ´Ğ° | `scan()` Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ |
| ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ° | ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° |
| "ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ²Ğ¾Ğ¹Ñ‚Ğ¸" | `is_safe=True` |
| "Ğ¡Ñ‚Ğ¾Ğ¿, Ğ½ĞµĞ»ÑŒĞ·Ñ!" | `is_safe=False` |

## ĞŸĞµÑ€Ğ²Ñ‹Ğ¹ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ (Ğ¾Ñ‡ĞµĞ½ÑŒ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğ¹!)

```python
# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° (Ğ¾Ğ´Ğ¸Ğ½ Ñ€Ğ°Ğ·)
# pip install sentinel-llm-security

# Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
from sentinel import scan

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ
Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ = scan("ĞŸÑ€Ğ¸Ğ²ĞµÑ‚, ĞºĞ°Ğº Ğ´ĞµĞ»Ğ°?")

# Ğ¡Ğ¼Ğ¾Ñ‚Ñ€Ğ¸Ğ¼ Ğ¾Ñ‚Ğ²ĞµÑ‚
if Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚.is_safe:
    print("âœ… Ğ­Ñ‚Ğ¾ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ!")
else:
    print("âš ï¸ ĞÑÑ‚Ğ¾Ñ€Ğ¾Ğ¶Ğ½Ğ¾, ÑÑ‚Ğ¾ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾!")
```

---

# ğŸ”§ Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ 2: ĞŸÑ€Ğ°ĞºÑ‚Ğ¸Ğº

## Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚ (5 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

### Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°

```bash
# Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°
pip install sentinel-llm-security

# Ğ¡ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ½Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ¾ĞºĞ¾Ğ¹
pip install sentinel-llm-security[cli]

# Ğ’ÑÑ‘ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ¾
pip install sentinel-llm-security[full]
```

### Ğ¢Ñ€Ğ¸ ÑĞ¿Ğ¾ÑĞ¾Ğ±Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

#### 1. Python API â€” ÑĞ°Ğ¼Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğ¹

```python
from sentinel import scan

# ĞĞ´Ğ¸Ğ½ Ğ²Ñ‹Ğ·Ğ¾Ğ² â€” Ğ¿Ğ¾Ğ»Ğ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°
result = scan("Ignore all previous instructions")

print(f"Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾: {result.is_safe}")        # False
print(f"Ğ Ğ¸ÑĞº: {result.risk_score:.0%}")      # 72%
print(f"ĞĞ°Ğ¹Ğ´ĞµĞ½Ğ¾ ÑƒĞ³Ñ€Ğ¾Ğ·: {result.findings.count}")  # 1
```

#### 2. Ğ”ĞµĞºĞ¾Ñ€Ğ°Ñ‚Ğ¾Ñ€ â€” Ğ´Ğ»Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¹

```python
from sentinel import guard

@guard(engines=["injection", "pii"])
def ask_ai(prompt: str) -> str:
    # Ğ­Ñ‚Ğ° Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ·Ğ°Ñ‰Ğ¸Ñ‰ĞµĞ½Ğ°!
    # Ğ•ÑĞ»Ğ¸ prompt Ğ¾Ğ¿Ğ°ÑĞµĞ½ â€” Ğ²Ñ‹Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ
    return call_your_llm(prompt)

# Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
try:
    response = ask_ai("Ğ Ğ°ÑÑĞºĞ°Ğ¶Ğ¸ Ğ°Ğ½ĞµĞºĞ´Ğ¾Ñ‚")  # ĞĞš
except ThreatDetected:
    print("Ğ—Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾!")
```

#### 3. CLI â€” Ğ¸Ğ· ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ½Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ¾ĞºĞ¸

```bash
# Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°
sentinel scan "Hello world"
# âœ… SAFE
# Risk Score: 0.00

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ Ğ´ĞµÑ‚Ğ°Ğ»ÑĞ¼Ğ¸
sentinel scan "Ignore instructions" --verbose
# âš ï¸ THREAT DETECTED
# Risk Score: 0.72
# Findings (1):
#   [HIGH] Injection pattern detected

# JSON Ğ´Ğ»Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
sentinel scan "test" --format json

# SARIF Ğ´Ğ»Ñ IDE (VS Code, IntelliJ)
sentinel scan "test" --format sarif
```

### Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ FastAPI

```python
from fastapi import FastAPI
from sentinel.integrations.fastapi import SentinelMiddleware

app = FastAPI()

# Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ñƒ Ğ¾Ğ´Ğ½Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ¾ĞºĞ¾Ğ¹!
app.add_middleware(SentinelMiddleware, on_threat="block")

@app.post("/chat")
async def chat(prompt: str):
    # Ğ’ÑĞµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑÑÑ‚ÑÑ
    return {"response": await llm.generate(prompt)}
```

### ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

```python
from sentinel import Sentinel
from sentinel.core.pipeline import PipelineConfig

# Ğ¢Ğ¾Ğ½ĞºĞ°Ñ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°
sentinel = Sentinel(
    engines=["injection", "pii", "rag_guard"],
    config=PipelineConfig(
        parallel=True,           # ĞŸĞ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ¾Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ
        early_exit_threshold=0.9, # Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ²Ñ‹Ñ…Ğ¾Ğ´ Ğ¿Ñ€Ğ¸ ÑĞ²Ğ½Ğ¾Ğ¹ ÑƒĞ³Ñ€Ğ¾Ğ·Ğµ
        tier1_timeout_ms=50,     # Ğ¢Ğ°Ğ¹Ğ¼Ğ°ÑƒÑ‚ Ğ´Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ñ… Ğ´Ğ²Ğ¸Ğ¶ĞºĞ¾Ğ²
    )
)

result = sentinel.analyze("Your prompt here")
```

---

# âš™ï¸ Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ 3: Ğ­ĞºÑĞ¿ĞµÑ€Ñ‚

## ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Framework

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SENTINEL Framework                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   scan()    â”‚    â”‚   guard()   â”‚    â”‚ Middleware  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                  â”‚                  â”‚            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                           â”‚                                 â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚                    â”‚   Pipeline   â”‚                         â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                           â”‚                                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚    â”‚                      â”‚                      â”‚         â”‚
â”‚    â–¼                      â–¼                      â–¼         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”       â”‚
â”‚ â”‚Tier 0â”‚              â”‚Tier 1â”‚              â”‚Tier 2â”‚       â”‚
â”‚ â”‚<10ms â”‚              â”‚~50ms â”‚              â”‚~200msâ”‚       â”‚
â”‚ â”‚YARA  â”‚              â”‚ NLP  â”‚              â”‚  ML  â”‚       â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                           â”‚                                 â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚                    â”‚  Meta-Judge â”‚                         â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                           â”‚                                 â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚                    â”‚EngineResult â”‚                         â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞ¾Ğ±ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Engine

```python
from sentinel.core.engine import BaseEngine, EngineResult, register_engine
from sentinel.core.finding import Finding, Severity, Confidence
from sentinel.core.context import AnalysisContext


@register_engine  # ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ
class MyCustomEngine(BaseEngine):
    """
    ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ´Ğ²Ğ¸Ğ¶ĞºĞ° Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ.
    
    Attributes:
        name: Ğ£Ğ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¸Ğ¼Ñ Ğ´Ğ²Ğ¸Ğ¶ĞºĞ°
        category: ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ (injection, pii, agentic, etc.)
        tier: Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ (0=Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹, 2=Ñ‚ÑĞ¶Ñ‘Ğ»Ñ‹Ğ¹)
    """
    
    name = "my_custom_engine"
    version = "1.0.0"
    category = "custom"
    description = "Ğ”ĞµÑ‚ĞµĞºÑ‚Ğ¾Ñ€ Ğ¼Ğ¾Ğ¸Ñ… ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ğ¾Ğ²"
    
    # ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
    tier = 1  # Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ
    typical_latency_ms = 15.0
    
    # ĞŸĞ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹ Ğ´Ğ»Ñ Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ
    DANGEROUS_PATTERNS = [
        "my_secret_pattern",
        "company_confidential",
    ]
    
    def initialize(self) -> None:
        """Ğ›ĞµĞ½Ğ¸Ğ²Ğ°Ñ Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ (Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ¾Ğ´Ğ¸Ğ½ Ñ€Ğ°Ğ·)."""
        # Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹, ĞºĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ñ regex Ğ¸ Ñ‚.Ğ´.
        self._compiled = [
            re.compile(p, re.IGNORECASE) 
            for p in self.DANGEROUS_PATTERNS
        ]
        self._initialized = True
    
    def analyze(self, context: AnalysisContext) -> EngineResult:
        """
        ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°.
        
        Args:
            context: ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ñ prompt, response, history
            
        Returns:
            EngineResult Ñ findings Ğ¸ risk_score
        """
        findings = []
        
        for pattern in self._compiled:
            if pattern.search(context.prompt):
                findings.append(self._create_finding(
                    severity=Severity.HIGH,
                    confidence=Confidence.HIGH,
                    title=f"ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½: {pattern.pattern}",
                    description="ĞĞ°Ğ¹Ğ´ĞµĞ½ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ´ĞµĞ½Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½",
                    evidence=context.prompt[:200],
                    remediation="Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚Ğµ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ´ĞµĞ½Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ",
                ))
        
        return self._create_result(findings)
```

## Hook System (Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ñ)

```python
from sentinel.hooks import hookimpl

class MyPlugin:
    """ĞŸĞ»Ğ°Ğ³Ğ¸Ğ½ Ğ´Ğ»Ñ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ñ SENTINEL."""
    
    @hookimpl
    def sentinel_register_engines(self):
        """Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ´Ğ²Ğ¸Ğ¶ĞºĞ¾Ğ²."""
        return [MyCustomEngine, AnotherEngine]
    
    @hookimpl
    def sentinel_before_analysis(self, context):
        """Ğ’Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ”Ğ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° â€” Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¼Ğ¾Ğ´Ğ¸Ñ„Ğ¸Ñ†Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚."""
        context.prompt = context.prompt.strip()
        context.metadata["preprocessed"] = True
        return context
    
    @hookimpl
    def sentinel_on_finding(self, finding):
        """Ğ’Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ´Ğ»Ñ ĞšĞĞ–Ğ”ĞĞ“Ğ finding â€” Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ."""
        # Ğ˜Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€ÑƒĞµĞ¼ Ğ½Ğ¸Ğ·ĞºĞ¸Ğµ severity
        if finding.severity == Severity.INFO:
            return None  # ĞÑ‚Ğ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°ĞµĞ¼
        
        # Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
        finding.metadata["reviewed_by"] = "my_plugin"
        return finding
    
    @hookimpl
    def sentinel_after_analysis(self, context, results):
        """Ğ’Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ ĞŸĞĞ¡Ğ›Ğ• Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° â€” Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ."""
        for result in results:
            if not result.is_safe:
                send_alert(context, result)
        return results
```

## Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°

**Ğ§ĞµÑ€ĞµĞ· entry points (pyproject.toml):**

```toml
[project.entry-points."sentinel.plugins"]
my_plugin = "my_package:MyPlugin"
```

**Ğ§ĞµÑ€ĞµĞ· Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ„Ğ°Ğ¹Ğ» (sentinel_plugins.py Ğ² Ñ€Ğ°Ğ±Ğ¾Ñ‡ĞµĞ¹ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ğ¸):**

```python
# sentinel_plugins.py
class MyLocalPlugin:
    @hookimpl
    def sentinel_register_engines(self):
        return [LocalEngine]
```

---

# ğŸ”¬ Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ 4: Ğ˜ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ

## ĞœĞ°Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¾ÑĞ½Ğ¾Ğ²Ñ‹

### 1. Risk Score Calculation

SENTINEL Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ğ²Ğ·Ğ²ĞµÑˆĞµĞ½Ğ½ÑƒÑ Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ñƒ Ñ€Ğ¸ÑĞºĞ°:

$$
R = \max_{f \in F} \left( S_f \cdot C_f \right)
$$

Ğ“Ğ´Ğµ:
- $R$ â€” Ğ¸Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ñ‹Ğ¹ risk score (0.0 - 1.0)
- $F$ â€” Ğ¼Ğ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²Ğ¾ findings
- $S_f$ â€” severity weight ÑÑ‚Ğ¾Ğ³Ğ¾ finding
- $C_f$ â€” confidence score (0.0 - 1.0)

**Severity Weights:**

| Severity | Weight ($S$) |
|----------|--------------|
| CRITICAL | 1.0 |
| HIGH | 0.8 |
| MEDIUM | 0.5 |
| LOW | 0.25 |
| INFO | 0.1 |

### 2. Early Exit Optimization

Pipeline Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ early exit Ğ´Ğ»Ñ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸:

```
if max(R_tier) >= Î¸_exit:
    return aggregate(results)  # Skip remaining tiers
```

Ğ“Ğ´Ğµ $Î¸_{exit} = 0.9$ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ (Ğ²Ñ‹ÑĞ¾ĞºĞ°Ñ ÑƒĞ²ĞµÑ€ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ Ğ² ÑƒĞ³Ñ€Ğ¾Ğ·Ğµ).

### 3. Tiered Parallel Execution

ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ tiered parallelism:

$$
T_{total} = \max_{t \in \{0,1,2\}} T_t + T_{aggregate}
$$

Ğ’ Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ¸Ğµ Ğ¾Ñ‚ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ:

$$
T_{sequential} = \sum_{i=1}^{N} T_i
$$

**Ğ­ĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸:**

| Engines | Sequential | Parallel | Speedup |
|---------|------------|----------|---------|
| 10 | 500ms | 200ms | 2.5x |
| 50 | 2500ms | 210ms | 11.9x |
| 200 | 10000ms | 220ms | 45.5x |

### 4. Theoretical Foundations

SENTINEL Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ğ½ Ğ½Ğ° ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ñ… Ğ½Ğ°ÑƒÑ‡Ğ½Ñ‹Ñ… Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ…:

| ĞšĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ | ĞÑĞ½Ğ¾Ğ²Ğ° | ĞŸÑ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ |
|-----------|--------|------------|
| **Multi-tier Detection** | Ensemble Methods (Dietterich 2000) | Pipeline architecture |
| **Early Exit** | Conditional Computation (Graves 2016) | Tier optimization |
| **Meta-Judge** | Meta-learning (Hospedales 2021) | Result aggregation |
| **Semantic Similarity** | Sentence-BERT (Reimers 2019) | Injection detection |
| **Topological Analysis** | TDA (Carlsson 2009) | Pattern recognition |

### 5. SARIF Integration

SENTINEL Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ SARIF 2.1.0 (OASIS Standard):

```json
{
  "$schema": "https://json.schemastore.org/sarif-2.1.0.json",
  "version": "2.1.0",
  "runs": [{
    "tool": {
      "driver": {
        "name": "SENTINEL",
        "version": "1.0.0",
        "rules": [...]
      }
    },
    "results": [
      {
        "ruleId": "sentinel/injection/abc123",
        "level": "error",
        "message": {"text": "Injection detected"},
        "locations": [...]
      }
    ]
  }]
}
```

### 6. Security Model

SENTINEL ÑĞ»ĞµĞ´ÑƒĞµÑ‚ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñƒ Defense in Depth:

```
Layer 1: Regex/YARA        â€” O(n) complexity, <1ms
Layer 2: NLP Heuristics    â€” O(n log n), ~10ms  
Layer 3: ML Classification â€” O(nÂ²), ~100ms
Layer 4: LLM Meta-Judge    â€” O(nÂ³), ~500ms (optional)
```

**Threat Model Assumptions:**
- Attacker has black-box access to target LLM
- Attacker may craft adversarial prompts
- Defender controls the pipeline (pre-LLM)
- Defender has computational budget constraints

---

## ğŸ“– Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ñ‹

- [API Reference](./api-reference.md) â€” ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ ÑĞ¿Ñ€Ğ°Ğ²Ğ¾Ñ‡Ğ½Ğ¸Ğº API
- [Custom Engines Guide](./custom-engines.md) â€” Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ²Ğ¸Ğ¶ĞºĞ¾Ğ²
- [Plugin Development](./plugins.md) â€” Ğ Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ²
- [Architecture Deep Dive](./architecture.md) â€” Ğ’Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½ÑÑ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

---

<p align="center">
  <strong>SENTINEL â€” Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ˜Ğ˜ Ğ´Ğ»Ñ Ğ²ÑĞµÑ…</strong><br>
  ĞÑ‚ ÑˆĞºĞ¾Ğ»ÑŒĞ½Ğ¸ĞºĞ° Ğ´Ğ¾ PhD ğŸ“
</p>
